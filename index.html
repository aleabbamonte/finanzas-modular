<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <meta name="theme-color" content="#00796b">
  <title>Finanzas Pro | Auratech</title>
  <link rel="manifest" href="./manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/styles.css">
  <link rel="stylesheet" href="./css/styles-fix.css">
</head>
<body>

    <!-- Pantalla de PIN -->
    <div id="pinScreen" style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: linear-gradient(135deg, #031a30 0%, #031422 100%); justify-content: center; align-items: center; z-index: 9999;">
        <div style="background: white; padding: 40px; border-radius: 20px; text-align: center; max-width: 400px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="font-size: 60px; margin-bottom: 20px;">ğŸ”</div>
            <h2 id="pinTitle" style="color: #031a30; margin-bottom: 10px; font-size: 24px;">Configura tu PIN</h2>
            <p id="pinSubtitle" style="color: #757575; margin-bottom: 30px; font-size: 14px;">Crea un PIN de 4 dÃ­gitos para proteger tus datos</p>
            
            <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px;">
                <div class="pin-dot" style="width: 20px; height: 20px; border-radius: 50%; border: 3px solid #031a30; transition: all 0.3s;"></div>
                <div class="pin-dot" style="width: 20px; height: 20px; border-radius: 50%; border: 3px solid #031a30; transition: all 0.3s;"></div>
                <div class="pin-dot" style="width: 20px; height: 20px; border-radius: 50%; border: 3px solid #031a30; transition: all 0.3s;"></div>
                <div class="pin-dot" style="width: 20px; height: 20px; border-radius: 50%; border: 3px solid #031a30; transition: all 0.3s;"></div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 300px; margin: 0 auto;">
                <button class="pin-btn" onclick="pinManager.addDigit(1)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">1</button>
                <button class="pin-btn" onclick="pinManager.addDigit(2)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">2</button>
                <button class="pin-btn" onclick="pinManager.addDigit(3)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">3</button>
                <button class="pin-btn" onclick="pinManager.addDigit(4)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">4</button>
                <button class="pin-btn" onclick="pinManager.addDigit(5)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">5</button>
                <button class="pin-btn" onclick="pinManager.addDigit(6)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">6</button>
                <button class="pin-btn" onclick="pinManager.addDigit(7)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">7</button>
                <button class="pin-btn" onclick="pinManager.addDigit(8)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">8</button>
                <button class="pin-btn" onclick="pinManager.addDigit(9)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">9</button>
                <button style="padding: 20px; background: transparent; border: none;"></button>
                <button class="pin-btn" onclick="pinManager.addDigit(0)" style="padding: 20px; font-size: 24px; font-weight: 700; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">0</button>
                <button class="pin-btn" onclick="pinManager.deleteDigit()" style="padding: 20px; font-size: 20px; background: #f5f5f5; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s;">âŒ«</button>
            </div>
            
            <p id="pinError" style="color: #c62828; margin-top: 20px; font-size: 14px; min-height: 20px;"></p>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo-container">
                <img src="https://i.postimg.cc/26fQFHJ8/logo.png" class="logo" alt="Finanzas Pro Logo">
            </div>
            <div class="brand">
                <h1>FINANZAS PRO</h1>
                <p class="tagline">by Auratechâ„¢</p>
            </div>
        </div>
        
        <div class="tabs" id="tabsContainer"></div>
        <div id="subtabsContainer"></div>
        
        <div class="content">
            <!-- RESUMEN -->
            <div id="tab-resumen" class="tab-content active">
                <div class="info-banner">
                    <div>ğŸ’¡</div>
                    <div>
			<h3>Panel de Control</h3>
				<p>
				<strong>AquÃ­ ves tu panorama financiero:</strong><br>
				<strong>ğŸ—‚ï¸ Tarjetas de datos:</strong> Ingresos, gastos por tipo (Fijos, Variables, Tarjetas, PrÃ©stamos) y balance mensual.<br>
				<strong>ğŸ“Š DistribuciÃ³n de Gastos:</strong> Compara visualmente tus gastos (Fijos, Variables y Cuotas) con barras proporcionales y porcentajes.<br>
				<strong>ğŸ’µ Campo USD:</strong> Actualiza el tipo de cambio automÃ¡ticamente o manual; convierte todos los montos a dÃ³lares.<br>
				<strong>ğŸ”” Alertas Inteligentes:</strong> Notificaciones sobre situaciones importantes en tus finanzas.
				</p>
			</div>
                </div>
                
				<div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px;">
                    <!-- Fila 1: Mes y AÃ±o -->
                    <div style="display: flex; gap: 8px;">
                        <select id="mesActual" onchange="app.actualizar()" style="flex: 1;"></select>
                        <select id="anioActual" onchange="app.actualizar()" style="flex: 1;"></select>
                    </div>
                    
                    <!-- Fila 2: USD y botÃ³n ? -->
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <div style="display: flex; gap: 6px; align-items: center; background: var(--bg-alt); padding: 6px 10px; border-radius: 8px; border: 2px solid var(--border); flex: 1;">
                            <span style="font-size: 16px;">ğŸ’µ</span>
                            <label style="font-size: 13px; font-weight: 600; color: var(--text);">USD:</label>
                            <input type="number" id="tipoCambio" placeholder="0" step="0.01" onchange="app.guardarTipoCambio()" style="flex: 1; padding: 4px 6px; border: 1px solid var(--border); height: 30px; font-size: 14px; box-sizing: border-box;" title="Tipo de cambio USD a ARS">
                            <button class="btn" onclick="app.actualizarDolar()" style="padding: 0 !important; background: var(--primary) !important; color: white; font-size: 14px; height: 30px !important; width: 30px !important; display: flex !important; align-items: center !important; justify-content: center !important; border: none !important; min-height: unset !important; margin: 0 !important;" title="Actualizar cotizaciÃ³n">ğŸ”„</button>
                        </div>
                        <button class="btn" onclick="app.mostrarAyuda()" style="background: #757575; color: white; padding: 6px 8px; width: 75px; display: flex; justify-content: center; align-items: center; font-size: 18px; min-height: unset !important; margin: 0 !important; height: 42px;">â“</button>
                    </div>
                    
                    <!-- Fila 3: Exportar e Importar -->
                    <div style="display: flex; gap: 8px;">
                        <button class="btn" onclick="app.exportar()" style="flex: 1; background: #757575; color: white; padding: 10px; min-height: unset !important; display: flex !important; align-items: center !important; justify-content: center !important; gap: 6px;">ğŸ“¥ Exportar</button>
						<button class="btn" onclick="document.getElementById('importFile').click()" style="flex: 1; background: #757575; color: white; padding: 10px; min-height: unset !important; display: flex !important; align-items: center !important; justify-content: center !important; gap: 6px;">ğŸ“¤ Importar</button>
                    </div>
                    
                    <input type="file" id="importFile" style="display:none" accept=".json" onchange="app.importar(event)">
                </div>
                
                <div class="cards" id="resumenCards"></div>
                
                <div class="section">
                    <div class="section-title">ğŸ“Š DistribuciÃ³n de Gastos</div>
                    <div class="expense-grid" id="desglose"></div>
                </div>
                
                <div class="section">
                    <div class="section-title">ğŸ”” Alertas Inteligentes</div>
                    <div id="alertas"></div>
                </div>
            </div>
            
            <!-- GESTIÃ“N - INGRESOS -->
            <div id="tab-gestion-ingresos" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ’µ</div>
                    <div><h3>Ingresos</h3><p>ğŸ’¡ <strong>CÃ³mo usar:</strong> Completa todos los campos y haz clic en "+ Agregar".<br> 
					</strong>Puedes registrar ingresos en ARS o USD.<br>
					</strong>El color te ayuda a identificar visualmente cada tipo de ingreso.</p></div>
                </div>
                <div class="section">
                    <div class="form-grid">
                        <input type="text" id="ing-nombre" placeholder="Nombre">
                        <select id="ing-cat"></select>
                        <select id="ing-moneda" title="Si el ingreso es en dÃ³lares, se convertirÃ¡ automÃ¡ticamente a pesos usando el tipo de cambio configurado">
                            <option value="ARS">ARS</option>
                            <option value="USD">USD</option>
                        </select>
                        <input type="text" id="ing-monto" placeholder="Monto" step="0.01">
                        <div style="grid-column: 1 / -1;">
                            <label style="display: block; margin-bottom: 8px; font-size: 12px; font-weight: 600; color: var(--text);">Color:</label>
                            <div class="color-picker">
                                <div class="color-option selected" style="background: #2e7d32;" onclick="app.seleccionarColor('ing', '#2e7d32', event)" title="Verde"></div>
                                <div class="color-option" style="background: #388e3c;" onclick="app.seleccionarColor('ing', '#388e3c', event)" title="Verde Medio"></div>
                                <div class="color-option" style="background: #689f38;" onclick="app.seleccionarColor('ing', '#689f38', event)" title="Verde Lima"></div>
                                <div class="color-option" style="background: #1976d2;" onclick="app.seleccionarColor('ing', '#1976d2', event)" title="Azul"></div>
                                <div class="color-option" style="background: #1565c0;" onclick="app.seleccionarColor('ing', '#1565c0', event)" title="Azul Oscuro"></div>
                                <div class="color-option" style="background: #0097a7;" onclick="app.seleccionarColor('ing', '#0097a7', event)" title="Cian"></div>
                                <div class="color-option" style="background: #00796b;" onclick="app.seleccionarColor('ing', '#00796b', event)" title="Verde Azulado"></div>
                                <div class="color-option" style="background: #7b1fa2;" onclick="app.seleccionarColor('ing', '#7b1fa2', event)" title="Morado"></div>
                                <div class="color-option" style="background: #5e35b1;" onclick="app.seleccionarColor('ing', '#5e35b1', event)" title="Violeta"></div>
                                <div class="color-option" style="background: #f57c00;" onclick="app.seleccionarColor('ing', '#f57c00', event)" title="Naranja"></div>
                                <div class="color-option" style="background: #fb8c00;" onclick="app.seleccionarColor('ing', '#fb8c00', event)" title="Naranja Claro"></div>
                                <div class="color-option" style="background: #fbc02d;" onclick="app.seleccionarColor('ing', '#fbc02d', event)" title="Amarillo"></div>
                                <div class="color-option" style="background: #fdd835;" onclick="app.seleccionarColor('ing', '#fdd835', event)" title="Amarillo Claro"></div>
                                <div class="color-option" style="background: #c2185b;" onclick="app.seleccionarColor('ing', '#c2185b', event)" title="Rosa"></div>
                                <div class="color-option" style="background: #d32f2f;" onclick="app.seleccionarColor('ing', '#d32f2f', event)" title="Rojo"></div>
                                <div class="color-option" style="background: #455a64;" onclick="app.seleccionarColor('ing', '#455a64', event)" title="Gris"></div>
                                <div class="color-option" style="background: #6d4c41;" onclick="app.seleccionarColor('ing', '#6d4c41', event)" title="MarrÃ³n"></div>
                                <div class="color-custom" onclick="document.getElementById('ing-color-custom').click()">ğŸ¨ Personalizado</div>
                                <input type="color" id="ing-color-custom" style="display: none;" onchange="app.seleccionarColor('ing', this.value, event)">
                            </div>
                            <input type="hidden" id="ing-color" value="#2e7d32">
                        </div>
                        <button class="btn btn-primary" onclick="app.add('ing')" style="grid-column: 1 / -1;">+ Agregar</button>
                    </div>
                    <div class="item-list" id="lista-ing"></div>
                </div>
            </div>
            
            <!-- GESTIÃ“N - GASTOS FIJOS -->
            <div id="tab-gestion-fijos" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ </div>
                    <div><h3>Gastos Fijos</h3><p>ğŸ’¡ <strong>CÃ³mo usar:</strong> Registra gastos que se repiten cada mes (alquiler, servicios, suscripciones).<br>
					</strong>Puedes usar USD si pagas en dÃ³lares.<br>
					</strong>Una vez guardados, se mostrarÃ¡n en el resumen mensual.</p></div>
                </div>
                <div class="section">
                    <div class="form-grid">
                        <input type="text" id="fij-nombre" placeholder="Nombre">
                        <select id="fij-cat"></select>
                        <select id="fij-moneda" title="Si el gasto es en dÃ³lares, se convertirÃ¡ automÃ¡ticamente a pesos usando el tipo de cambio configurado">
                            <option value="ARS">ARS</option>
                            <option value="USD">USD</option>
                        </select>
                        <input type="text" id="fij-monto" placeholder="Monto" step="0.01">
                        <div style="grid-column: 1 / -1;">
                            <label style="display: block; margin-bottom: 8px; font-size: 12px; font-weight: 600; color: var(--text);">Color:</label>
                            <div class="color-picker">
                                <div class="color-option" style="background: #d32f2f;" onclick="app.seleccionarColor('fij', '#d32f2f', event)" title="Rojo"></div>
                                <div class="color-option selected" style="background: #c62828;" onclick="app.seleccionarColor('fij', '#c62828', event)" title="Rojo Oscuro"></div>
                                <div class="color-option" style="background: #e64a19;" onclick="app.seleccionarColor('fij', '#e64a19', event)" title="Naranja Oscuro"></div>
                                <div class="color-option" style="background: #f57c00;" onclick="app.seleccionarColor('fij', '#f57c00', event)" title="Naranja"></div>
                                <div class="color-option" style="background: #fb8c00;" onclick="app.seleccionarColor('fij', '#fb8c00', event)" title="Naranja Claro"></div>
                                <div class="color-option" style="background: #7b1fa2;" onclick="app.seleccionarColor('fij', '#7b1fa2', event)" title="Morado"></div>
                                <div class="color-option" style="background: #5e35b1;" onclick="app.seleccionarColor('fij', '#5e35b1', event)" title="Violeta"></div>
                                <div class="color-option" style="background: #c2185b;" onclick="app.seleccionarColor('fij', '#c2185b', event)" title="Rosa"></div>
                                <div class="color-option" style="background: #ad1457;" onclick="app.seleccionarColor('fij', '#ad1457', event)" title="Rosa Oscuro"></div>
                                <div class="color-option" style="background: #1976d2;" onclick="app.seleccionarColor('fij', '#1976d2', event)" title="Azul"></div>
                                <div class="color-option" style="background: #1565c0;" onclick="app.seleccionarColor('fij', '#1565c0', event)" title="Azul Oscuro"></div>
                                <div class="color-option" style="background: #0097a7;" onclick="app.seleccionarColor('fij', '#0097a7', event)" title="Cian"></div>
                                <div class="color-option" style="background: #00796b;" onclick="app.seleccionarColor('fij', '#00796b', event)" title="Verde Azulado"></div>
                                <div class="color-option" style="background: #fbc02d;" onclick="app.seleccionarColor('fij', '#fbc02d', event)" title="Amarillo"></div>
                                <div class="color-option" style="background: #fdd835;" onclick="app.seleccionarColor('fij', '#fdd835', event)" title="Amarillo Claro"></div>
                                <div class="color-option" style="background: #455a64;" onclick="app.seleccionarColor('fij', '#455a64', event)" title="Gris"></div>
                                <div class="color-option" style="background: #6d4c41;" onclick="app.seleccionarColor('fij', '#6d4c41', event)" title="MarrÃ³n"></div>
                                <div class="color-custom" onclick="document.getElementById('fij-color-custom').click()">ğŸ¨ Personalizado</div>
                                <input type="color" id="fij-color-custom" style="display: none;" onchange="app.seleccionarColor('fij', this.value, event)">
                            </div>
                            <input type="hidden" id="fij-color" value="#c62828">
                        </div>
                        <button class="btn btn-primary" onclick="app.add('fij')" style="grid-column: 1 / -1;">+ Agregar</button>
                    </div>
                    <div class="item-list" id="lista-fij"></div>
                </div>
            </div>
            
            <!-- GESTIÃ“N - GASTOS VARIABLES -->
            <div id="tab-gestion-variables" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ›’</div>
                    <div><h3>Gastos Variables</h3><p>ğŸ’¡ <strong>CÃ³mo usar:</strong> Registra gastos que cambian mes a mes (comida, transporte, entretenimiento).<br>
					</strong>Elige la categorÃ­a correcta para que la app pueda comparar con tus presupuestos.<br>
					</strong>Los montos en USD se convierten automÃ¡ticamente.</p></div>
                </div>
                <div class="section">
                    <div class="form-grid">
                        <input type="text" id="var-nombre" placeholder="Nombre">
                        <select id="var-cat"></select>
                        <select id="var-moneda" title="Si el gasto es en dÃ³lares, se convertirÃ¡ automÃ¡ticamente a pesos usando el tipo de cambio configurado">
                            <option value="ARS">ARS</option>
                            <option value="USD">USD</option>
                        </select>
                        <input type="text" id="var-monto" placeholder="Monto" step="0.01">
                        <div style="grid-column: 1 / -1;">
                            <label style="display: block; margin-bottom: 8px; font-size: 12px; font-weight: 600; color: var(--text);">Color:</label>
                            <div class="color-picker">
                                <div class="color-option selected" style="background: #f57c00;" onclick="app.seleccionarColor('var', '#f57c00', event)" title="Naranja"></div>
                                <div class="color-option" style="background: #e64a19;" onclick="app.seleccionarColor('var', '#e64a19', event)" title="Naranja Oscuro"></div>
                                <div class="color-option" style="background: #fb8c00;" onclick="app.seleccionarColor('var', '#fb8c00', event)" title="Naranja Claro"></div>
                                <div class="color-option" style="background: #fbc02d;" onclick="app.seleccionarColor('var', '#fbc02d', event)" title="Amarillo"></div>
                                <div class="color-option" style="background: #fdd835;" onclick="app.seleccionarColor('var', '#fdd835', event)" title="Amarillo Claro"></div>
                                <div class="color-option" style="background: #689f38;" onclick="app.seleccionarColor('var', '#689f38', event)" title="Verde Lima"></div>
                                <div class="color-option" style="background: #0097a7;" onclick="app.seleccionarColor('var', '#0097a7', event)" title="Cian"></div>
                                <div class="color-option" style="background: #00796b;" onclick="app.seleccionarColor('var', '#00796b', event)" title="Verde Azulado"></div>
                                <div class="color-option" style="background: #1976d2;" onclick="app.seleccionarColor('var', '#1976d2', event)" title="Azul"></div>
                                <div class="color-option" style="background: #1565c0;" onclick="app.seleccionarColor('var', '#1565c0', event)" title="Azul Oscuro"></div>
                                <div class="color-option" style="background: #7b1fa2;" onclick="app.seleccionarColor('var', '#7b1fa2', event)" title="Morado"></div>
                                <div class="color-option" style="background: #5e35b1;" onclick="app.seleccionarColor('var', '#5e35b1', event)" title="Violeta"></div>
                                <div class="color-option" style="background: #c2185b;" onclick="app.seleccionarColor('var', '#c2185b', event)" title="Rosa"></div>
                                <div class="color-option" style="background: #ad1457;" onclick="app.seleccionarColor('var', '#ad1457', event)" title="Rosa Oscuro"></div>
                                <div class="color-option" style="background: #d32f2f;" onclick="app.seleccionarColor('var', '#d32f2f', event)" title="Rojo"></div>
                                <div class="color-option" style="background: #c62828;" onclick="app.seleccionarColor('var', '#c62828', event)" title="Rojo Oscuro"></div>
                                <div class="color-option" style="background: #455a64;" onclick="app.seleccionarColor('var', '#455a64', event)" title="Gris"></div>
                                <div class="color-option" style="background: #6d4c41;" onclick="app.seleccionarColor('var', '#6d4c41', event)" title="MarrÃ³n"></div>
                                <div class="color-custom" onclick="document.getElementById('var-color-custom').click()">ğŸ¨ Personalizado</div>
                                <input type="color" id="var-color-custom" style="display: none;" onchange="app.seleccionarColor('var', this.value, event)">
                            </div>
                            <input type="hidden" id="var-color" value="#f57c00">
                        </div>
                        <button class="btn btn-primary" onclick="app.add('var')" style="grid-column: 1 / -1;">+ Agregar</button>
                    </div>
                    <div class="item-list" id="lista-var"></div>
                </div>
            </div>
            
            <!-- GESTIÃ“N - TARJETAS -->
            <div id="tab-gestion-tarjetas" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ’³</div>
                    <div><h3>GestiÃ³n de Tarjetas</h3><p>ğŸ’¡ <strong>CÃ³mo usar:</strong> <br>â€¢ <strong>Compra Nueva:</strong> Si acabas de hacer la compra, ingresa el monto total, cuotas y fecha.<br>
					</strong>El sistema calcularÃ¡ todo automÃ¡ticamente.<br>â€¢ <strong>Compra Antigua:</strong> Si ya pagaste algunas cuotas, ingresa el valor de cada cuota y en quÃ© cuota estÃ¡s.<br>
					</strong>Haz clic en "âœ“ Pagar" cada vez que abonas una cuota.</p></div>
                </div>

                <div class="section">
                    <div class="card-mode-switch">
                        <button class="mode-btn active" onclick="app.cambiarModoTarjeta('completo')" title="Usa este modo si acabas de hacer la compra y conoces el monto total">
                            ğŸ“‹ Compra Nueva
                        </button>
                        <button class="mode-btn" onclick="app.cambiarModoTarjeta('rapido')" title="Usa este modo si ya pagaste algunas cuotas y solo sabes el valor de cada cuota">
                            âš¡ Compra Antigua
                        </button>
                    </div>

                    <!-- Modo Completo -->
                    <div id="tarjetaModoCompleto">
                        <div class="form-grid">
                            <input type="text" id="tarjeta-nombre" placeholder="Nombre de la compra">
                            <input type="text" id="tarjeta-tarjeta" placeholder="Nombre de tarjeta">
                            <input type="text" id="tarjeta-monto" placeholder="Monto total" step="0.01">
                            <input type="number" id="tarjeta-cuotas" placeholder="Total cuotas" min="1">
                            <input type="date" id="tarjeta-fecha">
                            <button class="btn btn-primary" onclick="app.agregarTarjetaCompleto()">+ Agregar</button>
                        </div>
                    </div>

                    <!-- Modo RÃ¡pido -->
                    <div id="tarjetaModoRapido" style="display: none;">
                        <div class="form-grid">
                            <input type="text" id="tarjeta-nombre-rapido" placeholder="Nombre de la compra">
                            <input type="text" id="tarjeta-tarjeta-rapido" placeholder="Nombre de tarjeta">
                            <input type="text" id="tarjeta-cuota-rapido" placeholder="Valor cuota" step="0.01">
                            <input type="number" id="tarjeta-cuotas-rapido" placeholder="Total cuotas" min="1">
                            <input type="number" id="tarjeta-actual-rapido" placeholder="Cuota actual" min="1">
                            <button class="btn btn-primary" onclick="app.agregarTarjetaRapido()">+ Agregar</button>
                        </div>
                    </div>

                    <div id="listaTarjetas" style="margin-top: 20px;"></div>
                </div>
            </div>

            <!-- GESTIÃ“N - PRÃ‰STAMOS -->
            <div id="tab-gestion-prestamos" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ¦</div>
                    <div><h3>GestiÃ³n de PrÃ©stamos</h3><p>ğŸ’¡ <strong>CÃ³mo usar:</strong> <br>â€¢ <strong>PrÃ©stamo Nuevo:</strong> Para prÃ©stamos recientes, ingresa el monto total y cantidad de cuotas.<br>â€¢ <strong>PrÃ©stamo Antiguo:</strong> Si ya comenzaste a pagarlo, ingresa el valor de la cuota y en cuÃ¡l estÃ¡s.<br>
					</strong>El sistema calcularÃ¡ automÃ¡ticamente cuÃ¡nto debes y las cuotas mensuales.</p></div>
                </div>

                <div class="section">
                    <div class="card-mode-switch">
                        <button class="mode-btn active" onclick="app.cambiarModoPrestamo('completo')" title="Usa este modo si acabas de solicitar el prÃ©stamo y conoces el monto total">
                            ğŸ“‹ PrÃ©stamo Nuevo
                        </button>
                        <button class="mode-btn" onclick="app.cambiarModoPrestamo('rapido')" title="Usa este modo si ya pagaste algunas cuotas y solo sabes el valor de cada cuota">
                            âš¡ PrÃ©stamo Antiguo
                        </button>
                    </div>

                    <!-- Modo Completo -->
                    <div id="prestamoModoCompleto">
                        <div class="form-grid">
                            <input type="text" id="prestamo-nombre" placeholder="Nombre del prÃ©stamo">
							<select id="prestamo-tipo">
							<option value="" disabled selected>Tipo de prÃ©stamo</option>
							<option value="personal">ğŸ’¼ Personal</option>
							<option value="hipotecario">ğŸ  Hipotecario</option>
							<option value="financiera">ğŸ¦ Financiera</option>
							<option value="familiar">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Familiar</option>
							<option value="amigo">ğŸ¤ Amigo</option>
							<option value="otro">ğŸ’° Otro</option>
							</select>
                            <input type="text" id="prestamo-monto" placeholder="Monto total" step="0.01">
                            <input type="number" id="prestamo-cuotas" placeholder="Total cuotas" min="1">
                            <input type="date" id="prestamo-fecha">
                            <button class="btn btn-primary" onclick="app.agregarPrestamoCompleto()">+ Agregar</button>
                        </div>
                    </div>

                    <!-- Modo RÃ¡pido -->
                    <div id="prestamoModoRapido" style="display: none;">
                        <div class="form-grid">
                            <input type="text" id="prestamo-nombre-rapido" placeholder="Nombre del prÃ©stamo">
							<select id="prestamo-tipo-rapido">
							<option value="" disabled selected>Tipo de prÃ©stamo</option>
							<option value="personal">ğŸ’¼ Personal</option>
							<option value="hipotecario">ğŸ  Hipotecario</option>
							<option value="financiera">ğŸ¦ Financiera</option>
							<option value="familiar">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Familiar</option>
							<option value="amigo">ğŸ¤ Amigo</option>
							<option value="otro">ğŸ’° Otro</option>
							</select>
                            <input type="text" id="prestamo-cuota-rapido" placeholder="Valor cuota" step="0.01">
                            <input type="number" id="prestamo-cuotas-rapido" placeholder="Total cuotas" min="1">
                            <input type="number" id="prestamo-actual-rapido" placeholder="Cuota actual" min="1">
                            <button class="btn btn-primary" onclick="app.agregarPrestamoRapido()">+ Agregar</button>
                        </div>
                    </div>

                    <div id="listaPrestamos" style="margin-top: 20px;"></div>
                </div>
            </div>
            
            <!-- METAS - AHORROS -->
            <div id="tab-metas-ahorros" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ·</div>
                    <div><h3>Metas de Ahorro</h3><p>ğŸ’¡ <strong>CÃ³mo usar:</strong> Primero establece una <strong>Meta</strong> (ej: "Vacaciones - $500.000").<br>
					</strong>Luego registra cada <strong>Ahorro</strong> que hagas.<br>
					</strong>La barra de progreso te mostrarÃ¡ cuÃ¡nto te falta para alcanzar tu objetivo.<br>
					</strong>Â¡Puedes tener mÃºltiples metas!</p></div>
                </div>
                <div class="section">
                    <div class="form-grid">
                        <input type="text" id="meta-nombre" placeholder="Meta">
                        <input type="text" id="meta-monto" placeholder="Objetivo $" step="0.01">
                        <button class="btn btn-primary" onclick="app.addMeta()">Establecer</button>
                    </div>
                    <div class="form-grid" style="margin-top:10px;">
                        <input type="text" id="aho-nombre" placeholder="Ahorro realizado">
                        <input type="text" id="aho-monto" placeholder="Monto $" step="0.01">
                        <button class="btn btn-success" onclick="app.addAhorro()">Registrar</button>
                    </div>
                    <div class="item-list" id="lista-aho"></div>
                    <div id="progresoAhorro" style="margin-top:15px;"></div>
                </div>
            </div>
            
            <!-- METAS - PRESUPUESTOS -->
            <div id="tab-metas-presupuestos" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ¯</div>
                    <div><h3>Presupuestos por CategorÃ­a</h3><p>ğŸ’¡ <strong>CÃ³mo usar:</strong> Define lÃ­mites de gasto para cada categorÃ­a (ej: "AlimentaciÃ³n - $200.000").<br>
					</strong>La app compararÃ¡ automÃ¡ticamente tus <strong>Gastos Variables</strong> registrados con estos lÃ­mites y te alertarÃ¡ si te estÃ¡s pasando.<br>
					</strong>Â¡Te ayuda a controlar mejor tus finanzas!</p></div>
                </div>
                <div class="section">
                    <div class="form-grid">
                        <select id="pres-cat"></select>
                        <input type="text" id="pres-monto" placeholder="LÃ­mite $" step="0.01">
                        <button class="btn btn-primary" onclick="app.addPresupuesto()">Establecer</button>
                    </div>
                    <div id="listaPresupuestos" style="margin-top:15px;"></div>
                </div>
            </div>
            
            <!-- HISTORIAL -->
            <div id="tab-historial" class="tab-content">
                <div class="info-banner">
                    <div>ğŸ“œ</div>
                    <div><h3>Historial de Actividad</h3><p>Registro automÃ¡tico de todas tus operaciones con fecha y hora.</p></div>
                </div>
                <div class="section">
                    <div id="listaHistorial"></div>
                </div>
            </div>
        </div>
    </div>
    
        <!-- Modal Ayuda -->
    <div id="modalAyuda" class="modal">
        <div class="modal-content">
            <div class="modal-header">Bienvenido a Finanzas Pro<br><small style="font-size:16px;font-weight:400;color:var(--text-light);">by Auratechâ„¢</small></div>
            <div class="modal-body">
                <p><strong>Tu asistente financiero profesional:</strong></p>
                <ul>
                    <li>ğŸ“Š Visualiza tu situaciÃ³n financiera en tiempo real</li>
                    <li>ğŸ’° Controla ingresos, gastos fijos y variables</li>
                    <li>ğŸ’³ Gestiona compras en cuotas y prÃ©stamos</li>
                    <li>ğŸ¯ Define metas de ahorro y presupuestos</li>
                    <li>ğŸ“ˆ Proyecta tu futuro financiero</li>
                    <li>ğŸ”” Recibe alertas inteligentes personalizadas</li>
                    <li>ğŸ’µ Registra gastos en USD convertidos automÃ¡ticamente a ARS</li>
                </ul>
                <p><strong>ğŸ’¡ Consejos:</strong></p>
                <ul>
                    <li>Actualiza el tipo de cambio USD en el panel de Resumen</li>
                    <li>Exporta tus datos regularmente como respaldo</li>
                    <li>Revisa las alertas para mantener finanzas saludables</li>
                    <li>Usa la proyecciÃ³n para planificar a futuro</li>
                </ul>
                <p style="text-align:center;color:var(--primary);font-weight:600;margin-top:18px;">Tu Ã©xito financiero comienza aquÃ­</p>
            </div>
            <button class="btn btn-primary" onclick="app.cerrarAyuda()" style="display:block;margin:20px auto 0;padding:12px 32px;">Comenzar</button>
        </div>
    </div>
        
    <!-- LibrerÃ­a de encriptaciÃ³n -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
    // Carrusel con scroll y activaciÃ³n automÃ¡tica del submenÃº centrado
    function autoActivateSubtabOnScroll(subtabsId) {
        const subtabs = document.getElementById(subtabsId);
        let ticking = false;
        if (!subtabs) return;
        subtabs.addEventListener('scroll', function() {
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    const subtabsRect = subtabs.getBoundingClientRect();
                    let closest, minDist = Infinity;
                    subtabs.querySelectorAll('.subtab').forEach(subtab => {
                        const rect = subtab.getBoundingClientRect();
                        // Distancia del centro de la subtab al centro del carrusel
                        const dist = Math.abs(rect.left + rect.width/2 - (subtabsRect.left + subtabsRect.width/2));
                        if (dist < minDist) {
                            closest = subtab; minDist = dist;
                        }
                    });
                    if (closest && !closest.classList.contains('active')) closest.click(); // dispara el cambio de submenÃº
                    ticking = false;
                });
                ticking = true;
            }
        });
    }
    // Asociar al init del app (por cada subtabs que se active dinÃ¡micamente)
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(()=>{
        document.querySelectorAll('.subtabs').forEach(sub => {
          autoActivateSubtabOnScroll(sub.id);
          // Si el tooltip no estÃ¡, lo agrega
          if(!sub.nextElementSibling || !sub.nextElementSibling.classList.contains('subtabs-tooltip')){
            const tt = document.createElement('div');
            tt.className = 'subtabs-tooltip';
            tt.innerText = 'Desliza para ver mÃ¡s opciones';
            sub.parentNode.insertBefore(tt, sub.nextSibling);
          }
        });
      }, 150);
    });
    </script>
    <script>
    function setupCarruselYTooltipSubtabs(){
      document.querySelectorAll('.subtabs').forEach(sub => {
        // Elimina tooltips previos mal colocados (si los hay)
        if(sub.previousElementSibling && sub.previousElementSibling.classList.contains('subtabs-tooltip')){
          sub.previousElementSibling.remove();
        }
        // Inserta el tooltip justo antes del carrusel
        const tt = document.createElement('div');
        tt.className = 'subtabs-tooltip';
        tt.innerText = 'Desliza para ver mÃ¡s opciones';
        sub.parentNode.insertBefore(tt, sub);
        // --- Scroll autoactivador solo si no existe ya
        if(!sub._autoScrollSetup){
          sub._autoScrollSetup = true;
          sub.addEventListener('scroll', function() {
            if(sub._ticking) return;
            sub._ticking = true;
            window.requestAnimationFrame(() => {
              const subtabsRect = sub.getBoundingClientRect();
              let closest, minDist = Infinity;
              sub.querySelectorAll('.subtab').forEach(subtab => {
                const rect = subtab.getBoundingClientRect();
                const dist = Math.abs(rect.left + rect.width/2 - (subtabsRect.left + subtabsRect.width/2));
                if (dist < minDist) { closest = subtab; minDist = dist; }
              });
              if (closest && !closest.classList.contains('active')) closest.click();
              sub._ticking = false;
            });
          });
        }
      });
    }
    document.addEventListener('DOMContentLoaded', setupCarruselYTooltipSubtabs);
    // Se recomienda llamar a setupCarruselYTooltipSubtabs() justo despuÃ©s de rearmar los subtabs, si son dinÃ¡micos.
    </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script type="module" src="./js/app.js"></script>
</body>
</html>
